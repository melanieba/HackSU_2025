<!DOCTYPE html>
<html lang="en">

<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header class="d-flex flex-wrap align-items-center justify-content-between py-3 mb-4 border-bottom">
        <a href="home.html" class="btn btn-outline-primary">â¬… Back to Home</a>
        <h2 class="text-center w-100">Past Mood Entries</h2>
    </header>

    <div class="container">
        <ul id="entries-list" class="list-group"></ul>
    </div>

    <script>
    async function fetchPastEntries() {
    try {
        console.log("Fetching past entries...");

        // Get the entries list element
        let list = document.getElementById("entries-list");
        console.log("Is entries-list found?", list);  // âœ… Debugging log

        if (!list) {
            console.error("Error: #entries-list element not found in the DOM!");
            return; // Stop execution if the list doesn't exist
        }

        let response = await fetch("http://127.0.0.1:5000/entries");
        let entries = await response.json();

        console.log("Entries received from API:", entries); // âœ… Log what we received

        list.innerHTML = ""; // Clear previous entries

        if (entries.length === 0) {
            console.log("No entries found.");
            list.innerHTML = "<li class='list-group-item'>No past entries yet.</li>";
        } else {
            entries.forEach(entry => {
                console.log("Processing entry:", entry); // âœ… Log each entry

                let moodText;
                switch (entry.moodID) {
                    case 1: moodText = "ğŸ˜¢ very bad"; break;
                    case 2: moodText = "ğŸ˜Ÿ bad"; break;
                    case 3: moodText = "ğŸ˜ okay"; break;
                    case 4: moodText = "ğŸ˜Š happy"; break;
                    case 5: moodText = "ğŸ˜„ very happy"; break;
                    default: moodText = "â“ Unknown Mood";
                }

                let journalText = entry.journalEntry ? entry.journalEntry : "No journal entry available";

                let listItem = document.createElement("li");
                listItem.classList.add("list-group-item");
                listItem.innerHTML = `
                    <strong>${entry.dateAndTime}</strong>: ${moodText} <br>
                    ğŸ“ <i>${journalText}</i>
                `;

                list.appendChild(listItem);
                console.log("Added entry to page:", listItem.innerHTML);
            });

            console.log("Entries successfully added to the page!");
        }
    } catch (error) {
        console.error("Error fetching past entries:", error);
    }
}


    // Fetch past entries when the page loads
    document.addEventListener("DOMContentLoaded", fetchPastEntries);
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
